let _ = require('lodash');

module.exports = function (data, gridSize) {
  let streetMap = _.range(gridSize).map(function (item, index) {
    return _.range(0, gridSize, 0); // grid of ground
  });

  function busPos(bus) {
    return bus.line.positions[
      parseInt(bus.location * bus.line.positions.length)
    ];
  }

  data.lines.forEach(function (line) {
    line.positions.forEach(function (position) {
      streetMap[position.x][position.y] = 'R'; // Road
    });
  });

  data.stops.forEach(function (stop) {
    streetMap[stop.pos.x][stop.pos.y] = 'S'; // Stop
  });

  data.buses.forEach(function (bus) {
    var pos = busPos(bus);
    streetMap[pos.x][pos.y] = 'B'; // Bus
  });

  return streetMap.map(function (row) {
    return row.map(function (cell) {
      return cell;
    }).join('');
  }).join('\n');
};


